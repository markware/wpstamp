/*! app 2016-04-07 */
function isVML(){return"undefined"!=typeof G_vmlCanvasManager}!function(a){a.fn.simplecarousel=function(b){var c={width:700,height:100,next:!1,prev:!1,vertical:!1,auto:!1,fade:!1,current:0,items:0,slidespeed:600,visible:1,pagination:!1,paginationItem:function(){return""},pauseOnClick:!1},d=a.extend(c,b),e=a(this),f=e.children("li");d.pauseOnClick&&f.bind("click",function(){d.auto=!1}),d.items=f.length;d.height,d.width;e.wrap('<div class="carousel-frame" style="overflow:hidden">');var g=e.parent(".carousel-frame");d.vertical?(e.width(d.width),e.height(d.items*d.height)):(e.width(d.items*d.width),e.height(d.height)),e.css("overflow","hidden"),f.each(function(b,c){a(c).width(d.width),a(c).height(d.height),d.vertical||a(c).css("float","left")});var h=function(a,b){var c=Math.abs(e.css("margin-left").split("p")[0]);"undefined"==typeof b&0==d.auto||("next"==a?(0==c&&"prev"==a||c==d.width*(d.items-2)/2&&"next"==a||(d.current+=d.visible),d.current>=d.items&&(d.current=0)):"prev"==a?(0==c&&"prev"==a||c==d.width*(d.items-2)/2&&"next"==a||(d.current-=d.visible),d.current<0&&(d.current=1==d.visible?d.items-1:d.items-2*d.visible+(d.visible-d.items%d.visible)),d.current==d.items&&(d.current=d.items-d.visible)):d.current=a,0!=d.pagination&&(g.next(".carousel-pagination").find("li").removeClass("carousel-pagination-active"),g.next(".carousel-pagination").find("li:nth-child("+(d.current+1)+")").addClass("carousel-pagination-active")),0!=d.fade?e.fadeOut(d.fade,function(){e.css({marginLeft:-1*d.current*d.width}),e.fadeIn(d.fade)}):d.vertical?e.animate({marginTop:-1*d.current*d.height},d.slidespeed):0==c&&"prev"==a||c==d.width*(d.items-2)/2&&"next"==a||e.animate({marginLeft:-1*d.current*d.width},d.slidespeed),"undefined"!=typeof b&&(d.auto=!1),0!=d.auto&&setTimeout(function(){h("next")},d.auto))};if(0!=d.pagination){g.after('<ul class="carousel-pagination"></ul>');for(var i=g.next(".carousel-pagination"),j=0;j<d.items;j++)i.append(0==j?'<li class="carousel-pagination-active">'+d.paginationItem(j+1)+"</li>":"<li>"+d.paginationItem(j+1)+"</li>");i.find("li").each(function(b){a(this).click(function(){h(b,!0)})})}0!=d.next&&d.next.click(function(){h("next",!0)}),0!=d.prev&&d.prev.click(function(){h("prev",!0)}),0!=d.auto&&setTimeout(function(){h("next")},d.auto)}}(jQuery),!function(a,b,c,d){"function"==typeof define&&define.amd?define(function(){return d(a,b,c)}):"object"==typeof exports?module.exports=d:a.ssm=d(a,b,c)}(window,document,void 0,function(a){"use strict";function b(a){this.message=a,this.name="Error"}function c(a){this.id=a.id||g(),this.query=a.query||"",delete a.id,delete a.query;var b={onEnter:[],onLeave:[],onResize:[],onFirstRun:[]};return this.options=f(b,a),"function"==typeof this.options.onEnter&&(this.options.onEnter=[this.options.onEnter]),"function"==typeof this.options.onLeave&&(this.options.onLeave=[this.options.onLeave]),"function"==typeof this.options.onResize&&(this.options.onResize=[this.options.onResize]),"function"==typeof this.options.onFirstRun&&(this.options.onFirstRun=[this.options.onFirstRun]),this.testConfigOptions("once")===!1?(this.valid=!1,!1):(this.valid=!0,this.active=!1,void this.init())}function d(){this.states=[],this.resizeTimer=null,this.configOptions=[],a.addEventListener("resize",i(this.resizeBrowser.bind(this),j),!0)}function e(a,b,c){for(var d=a.length,e=[],f=0;d>f;f++){var g=a[f];g[b]&&g[b]===c&&e.push(g)}return e}function f(a,b){var c={};for(var d in a)c[d]=a[d];for(var e in b)c[e]=b[e];return c}function g(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;10>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function h(a){for(var b=a.length,c=0;b>c;c++)a[c]()}function i(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}var j=25,k=function(){};return c.prototype={init:function(){this.test=a.matchMedia(this.query),this.test.matches&&this.testConfigOptions("match")&&this.enterState(),this.listener=this.test.addListener(function(a){var b=!1;a.matches?this.testConfigOptions("match")&&(this.enterState(),b=!0):(this.leaveState(),b=!0),b&&k()}.bind(this))},enterState:function(){h(this.options.onFirstRun),h(this.options.onEnter),this.options.onFirstRun=[],this.active=!0},leaveState:function(){h(this.options.onLeave),this.active=!1},resizeState:function(){this.testConfigOptions("resize")&&h(this.options.onResize)},destroy:function(){this.test.removeListener(this.listener)},testConfigOptions:function(a){for(var b=this.configOptions.length,c=0;b>c;c++){var d=this.configOptions[c];if("undefined"!=typeof this.options[d.name]&&d.when===a&&d.test.bind(this)()===!1)return!1}return!0},configOptions:[]},d.prototype={addState:function(a){var b=new c(a);return b.valid&&this.states.push(b),b},addStates:function(a){for(var b=a.length-1;b>=0;b--)this.addState(a[b]);return this},getState:function(a){for(var b=this.states.length-1;b>=0;b--){var c=this.states[b];if(c.id===a)return c}},isActive:function(a){var b=this.getState(a)||{};return b.active||!1},getStates:function(a){var b=null,c=[];if("undefined"==typeof a)return this.states;b=a.length;for(var d=0;b>d;d++)c.push(this.getState(a[d]));return c},removeState:function(a){for(var b=this.states.length-1;b>=0;b--){var c=this.states[b];c.id===a&&(c.destroy(),this.states.splice(b,1))}return this},removeStates:function(a){for(var b=a.length-1;b>=0;b--)this.removeState(a[b]);return this},removeAllStates:function(){for(var a=this.states.length-1;a>=0;a--){var b=this.states[a];b.destroy()}this.states=[]},addConfigOption:function(a){var b={name:"",test:null,when:"resize"};a=f(b,a),""!==a.name&&null!==a.test&&c.prototype.configOptions.push(a)},removeConfigOption:function(a){for(var b=c.prototype.configOptions,d=b.length-1;d>=0;d--)b[d].name===a&&b.splice(d,1);c.prototype.configOptions=b},getConfigOption:function(a){var b=c.prototype.configOptions;if("string"!=typeof a)return b;for(var d=b.length-1;d>=0;d--)if(b[d].name===a)return b[d]},getConfigOptions:function(){return c.prototype.configOptions},resizeBrowser:function(){for(var a=e(this.states,"active",!0),b=a.length,c=0;b>c;c++)a[c].resizeState()},stateChange:function(a){if("function"!=typeof a)throw new b("Not a function");k=a}},new d}),function(a){a.fn.visible=function(b){var c=a(this),d=a(window),e=d.scrollTop(),f=e+d.height(),g=c.offset().top,h=g+c.height(),i=b===!0?h:g,j=b===!0?g:h;return f>=j&&i>=e}}(jQuery),function(a){"use strict";var b=a.fabric||(a.fabric={}),c=b.util.object.extend,d=b.util.object.clone;if(b.CurvedText)return void b.warn("fabric.CurvedText is already defined");var e=b.Text.prototype.stateProperties.concat();e.push("radius","spacing","reverse","effect","range","largeFont","smallFont");var f=b.Text.prototype._dimensionAffectingProps;f.radius=!0,f.spacing=!0,f.reverse=!0,f.fill=!0,f.effect=!0,f.width=!0,f.height=!0,f.range=!0,f.fontSize=!0,f.shadow=!0,f.largeFont=!0,f.smallFont=!0;var g=b.Group.prototype.delegatedProperties;g.backgroundColor=!0,g.textBackgroundColor=!0,g.textDecoration=!0,g.stroke=!0,g.strokeWidth=!0,g.shadow=!0,b.CurvedText=b.util.createClass(b.Text,b.Collection,{type:"curvedText",radius:50,range:5,smallFont:10,largeFont:30,effect:"curved",spacing:0,reverse:!1,stateProperties:e,delegatedProperties:g,_dimensionAffectingProps:f,_isRendering:0,complexity:function(){this.callSuper("complexity")},initialize:function(a,c){c||(c={}),this.letters=new b.Group([],{selectable:!1,padding:0}),this.__skipDimension=!0,this.setOptions(c),this.__skipDimension=!1,this.setText(a)},setText:function(a){if(this.letters){for(;0!==a.length&&this.letters.size()>=a.length;)this.letters.remove(this.letters.item(this.letters.size()-1));for(var c=0;c<a.length;c++)void 0===this.letters.item(c)?this.letters.add(new b.Text(a[c])):this.letters.item(c).setText(a[c])}this.callSuper("setText",a)},_initDimensions:function(a){if(!this.__skipDimension){a||(a=b.util.createCanvasElement().getContext("2d"),this._setTextStyles(a)),this._textLines=this.text.split(this._reNewline),this._clearCache();var c=this.textAlign;this.textAlign="left",this.width=this._getTextWidth(a),this.textAlign=c,this.height=this._getTextHeight(a),this._render(a)}},_render:function(a){var c=b.util.getRandomInt(100,999);if(this._isRendering=c,this.letters){var d=0,e=0,f=0,g=0,h=parseInt(this.spacing),i=0;if("curved"==this.effect){for(var j=0,k=this.text.length;k>j;j++)g+=this.letters.item(j).width+h;g-=h}else"arc"==this.effect&&(i=(this.letters.item(0).fontSize+h)/this.radius/(Math.PI/180),g=(this.text.length+1)*(this.letters.item(0).fontSize+h));d="right"===this.get("textAlign")?90-g/2/this.radius/(Math.PI/180):"left"===this.get("textAlign")?-90-g/2/this.radius/(Math.PI/180):-(g/2/this.radius/(Math.PI/180)),this.reverse&&(d=-d);for(var l=0,m=this.reverse?-1:1,n=0,o=0,j=0,k=this.text.length;k>j;j++){if(c!==this._isRendering)return;for(var p in this.delegatedProperties)this.letters.item(j).set(p,this.get(p));if(this.letters.item(j).set("left",l),this.letters.item(j).set("top",0),this.letters.item(j).setAngle(0),this.letters.item(j).set("padding",0),"curved"===this.effect)n=(this.letters.item(j).width+h)/this.radius/(Math.PI/180),e=m*(m*d+o+n/2),d=m*(m*d+o),f=d*(Math.PI/180),o=n,this.letters.item(j).setAngle(e),this.letters.item(j).set("top",-1*m*Math.cos(f)*this.radius),this.letters.item(j).set("left",m*Math.sin(f)*this.radius),this.letters.item(j).set("padding",0),this.letters.item(j).set("selectable",!1);else if("arc"===this.effect)d=m*(m*d+i),f=d*(Math.PI/180),this.letters.item(j).set("top",-1*m*Math.cos(f)*this.radius),this.letters.item(j).set("left",m*Math.sin(f)*this.radius),this.letters.item(j).set("padding",0),this.letters.item(j).set("selectable",!1);else if("STRAIGHT"===this.effect)this.letters.item(j).set("left",l),this.letters.item(j).set("top",0),this.letters.item(j).setAngle(0),l+=this.letters.item(j).get("width"),this.letters.item(j).set("padding",0),this.letters.item(j).set({borderColor:"red",cornerColor:"green",cornerSize:6,transparentCorners:!1}),this.letters.item(j).set("selectable",!1);else if("smallToLarge"===this.effect){var q=parseInt(this.smallFont),r=parseInt(this.largeFont),s=r-q,t=Math.ceil(this.text.length/2),u=s/this.text.length,v=q+j*u;this.letters.item(j).set("fontSize",v),this.letters.item(j).set("left",l),l+=this.letters.item(j).get("width"),this.letters.item(j).set("padding",0),this.letters.item(j).set("selectable",!1),this.letters.item(j).set("top",-1*this.letters.item(j).get("fontSize")+j)}else if("largeToSmallTop"===this.effect){var q=parseInt(this.largeFont),r=parseInt(this.smallFont),s=r-q,t=Math.ceil(this.text.length/2),u=s/this.text.length,v=q+j*u;this.letters.item(j).set("fontSize",v),this.letters.item(j).set("left",l),l+=this.letters.item(j).get("width"),this.letters.item(j).set("padding",0),this.letters.item(j).set({borderColor:"red",cornerColor:"green",cornerSize:6,transparentCorners:!1}),this.letters.item(j).set("padding",0),this.letters.item(j).set("selectable",!1),this.letters.item(j).top=-1*this.letters.item(j).get("fontSize")+j/this.text.length}else if("largeToSmallBottom"===this.effect){var q=parseInt(this.largeFont),r=parseInt(this.smallFont),s=r-q,t=Math.ceil(this.text.length/2),u=s/this.text.length,v=q+j*u;this.letters.item(j).set("fontSize",v),this.letters.item(j).set("left",l),l+=this.letters.item(j).get("width"),this.letters.item(j).set("padding",0),this.letters.item(j).set({borderColor:"red",cornerColor:"green",cornerSize:6,transparentCorners:!1}),this.letters.item(j).set("padding",0),this.letters.item(j).set("selectable",!1),this.letters.item(j).top=-1*this.letters.item(j).get("fontSize")-j}else if("bulge"===this.effect){var q=parseInt(this.smallFont),r=parseInt(this.largeFont),s=r-q,t=Math.ceil(this.text.length/2),u=s/(this.text.length-t);if(t>j)var v=q+j*u;else var v=r-(j-t+1)*u;this.letters.item(j).set("fontSize",v),this.letters.item(j).set("left",l),l+=this.letters.item(j).get("width"),this.letters.item(j).set("padding",0),this.letters.item(j).set("selectable",!1),this.letters.item(j).set("top",-1*this.letters.item(j).get("height")/2)}}this.letters._calcBounds(),this.letters._updateObjectsCoords(),this.letters.saveCoords(),this.letters.render(a),this.width=this.letters.width,this.height=this.letters.height,this.letters.left=-(this.letters.width/2),this.letters.top=-(this.letters.height/2)}},_renderOld:function(){if(this.letters){var a=0,b=0,c=0;"center"===this.get("textAlign")||"justify"===this.get("textAlign")?c=this.spacing/2*(this.text.length-1):"right"===this.get("textAlign")&&(c=this.spacing*(this.text.length-1));for(var d=this.reverse?1:-1,e=0,f=this.text.length;f>e;e++){a=d*(-e*parseInt(this.spacing,10)+c),b=a*(Math.PI/180);for(var g in this.delegatedProperties)this.letters.item(e).set(g,this.get(g));this.letters.item(e).set("top",-Math.cos(b)*this.radius),this.letters.item(e).set("left",+Math.sin(b)*this.radius),this.letters.item(e).setAngle(a),this.letters.item(e).set("padding",0),this.letters.item(e).set("selectable",!1)}this.letters._calcBounds(),this.letters._updateObjectsCoords(),this.letters.saveCoords(),this.width=this.letters.width,this.height=this.letters.height,this.letters.left=-(this.letters.width/2),this.letters.top=-(this.letters.height/2)}},render:function(a){if(this.visible&&this.letters){this.transform(a);{Math.max(this.scaleX,this.scaleY)}this.clipTo&&b.util.clipContext(this,a);for(var c=0,d=this.letters.size();d>c;c++){{var e=this.letters.item(c);e.borderScaleFactor,e.hasRotatingPoint}e.visible&&e.render(a)}this.clipTo&&a.restore(),this.setCoords()}},_set:function(a,b){this.callSuper("_set",a,b),this.letters&&(this.letters.set(a,b),a in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords()))},toObject:function(a){var b=c(this.callSuper("toObject",a),{radius:this.radius,spacing:this.spacing,reverse:this.reverse,effect:this.effect,range:this.range,smallFont:this.smallFont,largeFont:this.largeFont});return this.includeDefaultValues||this._removeDefaultValues(b),b},toString:function(){return"#<fabric.CurvedText ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'", "radius": "'+this.radius+'", "spacing": "'+this.spacing+'", "reverse": "'+this.reverse+'" }>'},toSVG:function(a){var b=["<g ",'transform="',this.getSvgTransform(),'">'];if(this.letters)for(var c=0,d=this.letters.size();d>c;c++)b.push(this.letters.item(c).toSVG(a));return b.push("</g>"),a?a(b.join("")):b.join("")}}),b.CurvedText.fromObject=function(a){return new b.CurvedText(a.text,d(a))},b.util.createAccessors(b.CurvedText),b.CurvedText.async=!1}("undefined"!=typeof exports?exports:this),function(a){a.fn.fontselect=function(){var b=function(a,b){return function(){return a.apply(b,arguments)}};tmp_fonts=fa_settings.setting_font_list_.replace(/%2B/g,"+");var c=tmp_fonts.split(","),d={style:"font-select",placeholder:"Select a font",lookahead:1,pager:10,api:"https://fonts.googleapis.com/css?family="},e=function(){function d(b,c){this.$original=a(b),this.options=c,this.active=!1,this.setupHtml(),this.getVisibleFonts(),this.scrollEvent(),this.bindEvents();var d=this.$original.val();d&&(this.updateSelected(),this.addFontLink(d))}return d.prototype.bindEvents=function(){this.$results.on("click","li.font-family",b(this.selectFont,this)).on("mouseenter","li",b(this.activateFont,this)).on("mouseleave","li",b(this.deactivateFont,this)),this.$results.on("click","span",b(this.toggleDrop,this)),this.$select.on("click","span",b(this.toggleDrop,this))},d.prototype.toggleDrop=function(){this.active?(this.$element.removeClass("font-select-active"),this.$drop.removeClass("show"),clearInterval(this.visibleInterval)):(this.$element.addClass("font-select-active"),this.$drop.addClass("show"),a(".dropdown-menu").niceScroll(),this.moveToSelected(),this.visibleInterval=setInterval(b(this.getVisibleFonts,this),500)),this.active=!this.active},d.prototype.selectFont=function(){var b=a("li.active",this.$results).data("value");this.$original.val(b).change(),this.updateSelected(),this.toggleDrop()},d.prototype.moveToSelected=function(){var b,c=this.$original.val();b=c?a("li[data-value='"+c+"']",this.$results):a("li",this.$results).first()},d.prototype.activateFont=function(b){a("li.active",this.$results).removeClass("active"),a(b.currentTarget).addClass("active")},d.prototype.deactivateFont=function(b){a(b.currentTarget).removeClass("active")},d.prototype.updateSelected=function(){var b=this.$original.val();a("span",this.$element).text(this.toReadable(b)).css(this.toStyle(b))},d.prototype.setupHtml=function(){this.$original.empty(),this.$element=a("<div>",{"class":this.options.style}),this.$arrow=a(""),this.$select=a("<a><span>"+this.options.placeholder+'<em class="material-icons">expand_more</em></span></a>'),this.$drop=a("<div>",{"class":"fs-drop dropdown-menu"}),this.$results=a("<ul>",{"class":"fs-results"}),this.$original.after(this.$element.append(this.$select.append(this.$arrow)).append(this.$drop)),this.$drop.append(this.$results.append(this.fontsAsHtml(0)))},d.prototype.scrollLoader=function(){var b=this.$drop.find("div:last-child");if(1==b.visible()){var c=b.data("point");this.$drop.append(this.$results.append(this.fontsAsHtml(c+1)))}a(".dropdown-menu").getNiceScroll().resize()},d.prototype.scrollEvent=function(){this.$drop.scroll(b(this.scrollLoader,this))},d.prototype.fontsAsHtml=function(a){for(var b,d,e=this.options.pager,f="",g=a;e+a>=g;g++)a+e-1>=c.length||(b=this.toReadable(c[g]),d=this.toStyle(c[g]),f+='<li class="font-family" data-value="'+c[g]+'" style="font-family: '+d["font-family"]+';">'+b+"</li>",g==a+e&&(f+='<div data-point="'+(a+e)+'"></div>'));return f},d.prototype.toReadable=function(a){return a?a.replace(/[\+|:]/g," "):void 0},d.prototype.toStyle=function(a){var b=a.split(":");return{"font-family":this.toReadable(b[0]),"font-weight":b[1]||400}},d.prototype.getVisibleFonts=function(){if(!this.$results.is(":hidden")){var b=this,c=this.$results.scrollTop(),d=c+this.$results.height();if(this.options.lookahead){var e=a("li",this.$results).first().height();d+=e*this.options.lookahead}a("li",this.$results).each(function(){var e=a(this).position().top+c,f=e+a(this).height();if(f>=c&&d>=e){var g=a(this).data("value");b.addFontLink(g)}})}},d.prototype.addFontLink=function(b){var c=this.options.api+b;0===a("link[href*='"+b+"']").length&&a("link:last").after('<link href="'+c+'" rel="stylesheet" type="text/css">')},d}();return this.each(function(b){return b&&a.extend(d,b),new e(this,d)})}}(jQuery),function(){var a=document.createElement("script");a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js",a.type="text/javascript",a.async="true";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}();var topLeftImage=new Image;topLeftImage.src="../wp-content/plugins/wpstamp/public/img/delete.png";var topRightImage=new Image;topRightImage.src="../wp-content/plugins/wpstamp/public/img/fa_rotate.png";var bottomRightImage=new Image;bottomRightImage.src="../wp-content/plugins/wpstamp/public/img/fa_resize.png";var bottomLeftImage=new Image;bottomLeftImage.src="../wp-content/plugins/wpstamp/public/img/fa_layers.png",fabric.Object.prototype._drawControl=function(a,b,c,d,e){var f=12;this.isControlVisible(a)&&(isVML()||this.transparentCorners||b.clearRect(d,e,f,f)),"bl"==a?(this.cornerSize=f+5,b.drawImage(bottomLeftImage,d,e,f+5,f+5)):"br"==a?(this.cornerSize=f+5,b.drawImage(bottomRightImage,d,e,f+5,f+5)):"mtr"==a?(this.cornerSize=f+5,b.drawImage(topRightImage,d,e,f+5,f+5)):(this.cornerSize=f,b[c](d+1,e+1,f,f))};var cursorOffset={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7};degreesToRadians=fabric.util.degreesToRadians,fabric.util.object.extend(fabric.Canvas.prototype,{setCursor:function(a){this.upperCanvasEl.style.cursor=a},_getActionFromCorner:function(a,b){if(b&&"mtr"===b){var c=a?"rotate":"rotate";return c}},_setCornerCursor:function(a,b){if("mtr"===a&&b.hasRotatingPoint)this.setCursor(this.rotationCursor);else if("bl"===a&&b.hasRotatingPoint)this.setCursor(this.defaultCursor);else{if(!(a in cursorOffset))return this.setCursor(this.defaultCursor),!1;this.setCursor(this._getRotatedCornerCursor(a,b))}}}),fabric.Canvas.prototype._getActionFromCorner=function(a,b){var c="drag";return b&&(c="ml"===b||"mr"===b?"scaleX":"mt"===b||"mb"===b?"scaleY":"tl"===b?"rotate":"scale","tr"==b&&(c="drag"),"mtr"==b&&(c="rotate"),"bl"==b&&(c="rotate",wpStamp.lockSelected())),c};var wpStamp={canvas:"",a:"",b:"",$color:"",imgf:"",imgb:"",front:"",back:"",state:[],mods:0,hasback:1,lineAdded:!1,lineW:"",lineH:"",copiedObject:"",copiedObjects:[],mobile:!1,allProducts:[],newleft:0,drawline:"",line:"",isDown:"",zoom:1,side:"back",holders:[],sliders:[],mainColorTool:0,ratio:1,b_json:[],a_json:[],state:[],mods:0,screenState:function(){ssm.addStates([{id:"mobile",query:"(max-width: 767px)",onEnter:function(){var a=$(".t-container").attr("data-width"),b=$(".t-container").attr("data-height");wpStamp.reShape(a,b),wpStamp.mobile=!0}},{id:"screen",query:"(min-width: 768px)",onEnter:function(){wpStamp.resetShape()}}])},resetShape:function(){wpStamp.ratio=1;var a=$("#drawingArea");$(".frontside,.backside,.helper,#drawingArea").css("width",a.attr("data-width")),$(".frontside,.backside,.helper,#drawingArea").css("height",a.attr("data-height")),wpStamp.realArea(),wpStamp.canvas&&(wpStamp.canvas.setWidth(a.attr("data-width")),wpStamp.canvas.setHeight(a.attr("data-height")),wpStamp.renderCanvas())},reShape:function(a,b){var c=$("#drawingArea"),a=Number(a),b=Number(b),d=$(".designer-container").width(),e=d/a;wpStamp.ratio=e;var f=b*wpStamp.ratio;$(".frontside,.backside,.helper,#drawingArea").css("width",d),$(".frontside,.backside,.helper,#drawingArea").css("height",f);var g=(c.position(),wpStamp.canvas.getObjects());for(var h in g){var i=g[h].scaleX,j=g[h].scaleY,k=g[h].left,l=g[h].top;if(1==wpStamp.ratio)var m=i*wpStamp.ratio/i,n=j*wpStamp.ratio/j,o=k*wpStamp.ratio/k,p=l*wpStamp.ratio/l;else var m=i*wpStamp.ratio,n=j*wpStamp.ratio,o=k*wpStamp.ratio,p=l*wpStamp.ratio;g[h].scaleX=m,g[h].scaleY=n,g[h].left=o,g[h].top=p,g[h].setCoords()}wpStamp.canvas.renderAll(),wpStamp.canvas.calcOffset(),wpStamp.realArea(),wpStamp.canvas&&(wpStamp.canvas.setWidth(d),wpStamp.canvas.setHeight(f),wpStamp.renderCanvas())},lockSelected:function(){var a=wpStamp.canvas.getActiveObject();0==a.lockMovementX&&0==a.lockMovementY?(a.lockMovementX=!0,a.lockMovementY=!0):(a.lockMovementX=!1,a.lockMovementY=!1),wpStamp.renderCanvas()},init:function(){wpStamp.canvas=new fabric.Canvas("tcanvas"),wpStamp.canvas.controlsAboveOverlay=!0,wpStamp.canvas.stateful=!1,wpStamp.canvas.counter=0,wpStamp.canvas.setWidth($("#drawingArea").width()),wpStamp.canvas.setHeight($("#drawingArea").height()),wpStamp.canvas.calcOffset().renderAll(),wpStamp.canvas.on({"object:selected":wpStamp.onObjectSelected,"selection:cleared":wpStamp.onSelectedCleared,"object:moving":wpStamp.onObjectMoving,"mouse:up":wpStamp.onMouseUp,"mouse:move":wpStamp.paintPlugin.moveLine,"mouse:down":wpStamp.paintPlugin.startLine,"object:added":wpStamp.onObjectAdded,"object:removed":wpStamp.checkPrice}),wpStamp.realArea(),wpStamp.screenState(),wpStamp.layersPlugin.load(),wpStamp.loadProducts(),wpStamp.clickControllers(),wpStamp.textPlugin.load(),wpStamp.paintPlugin.load(),wpStamp.variationPlugin.load(),wpStamp.createListenersKeyboard(),wpStamp.initCustomization(),$("a[title]").tooltipster();var a=$("#tshirtFacing").data("back");""==a&&(wpStamp.hasback=0,$("#flip").remove()),$("body").on("click","#product-changer a",function(a){a.preventDefault();var b=$(this).attr("data-id");$("#product-changer li").removeClass("active"),$(this).parent().addClass("active"),wpStamp.changeProduct(b)})},layersPlugin:{load:function(){var a=$("#layers");a.sortable().bind("sortstop",function(){for(var a=$("#layers li:not(.ui-sortable-placeholder)"),b=a.length-1;b>=0;b--){var c=wpStamp.getObjectById(a[b].id);wpStamp.canvas.bringToFront(c)}}),a.on("click","li",function(){var b=$(this).attr("data-id"),c=wpStamp.getObjectById(b);console.log(c,b),c&&(a.find("li").removeClass("active"),$(this).addClass("active"),wpStamp.canvas.setActiveObject(c))}),a.niceScroll()},add:function(a,b,c){var d=$("#layers");d.find(".nothing").remove();var e='<a class="remove-selected" data-tooltip="Delete selected item"><em class="material-icons">delete</em> </a>';d.prepend('<li id="'+a+'" data-id="'+a+'"><em class="material-icons">'+b+"</em>"+c+" "+a+'<div class="small-tools">'+e+"</div></li>"),d.getNiceScroll().resize(),d.sortable("reload")},remove:function(){},select:function(){}},realArea:function(a){var a="undefined"==typeof a?"1":a;if("back"==wpStamp.side){var b=$("#tcanvas").attr("data-shape");Number($("#tcanvas").attr("data-left")),Number($("#tcanvas").attr("data-top")),Number($("#tcanvas").attr("data-width")),Number($("#tcanvas").attr("data-height"))}else var b=(Number($("#tcanvas").attr("data-leftb")),Number($("#tcanvas").attr("data-topb")),Number($("#tcanvas").attr("data-widthb")),Number($("#tcanvas").attr("data-heightb")),$("#tcanvas").attr("data-shapeb"));if(b){var c=JSON.parse(b);c.objects[0].fill="transparent",c.objects[0].scaleX=c.objects[0].scaleX,c.objects[0].scaleY=c.objects[0].scaleY;var d=c.objects[0].top,e=c.objects[0].left,f=d*wpStamp.ratio*a-d*wpStamp.ratio,g=e*wpStamp.ratio*a-e*wpStamp.ratio;c.objects[0].top=d*wpStamp.ratio-2*f,c.objects[0].left=e*wpStamp.ratio-g,c.objects[0].width=c.objects[0].width*a*wpStamp.ratio,c.objects[0].height=c.objects[0].height*a*wpStamp.ratio,c.objects[0].radius=c.objects[0].radius*a*wpStamp.ratio,wpStamp.canvas.clipTo=function(a){if(c.objects[0].type&&"rect"==c.objects[0].type)var b=new fabric.Rect(c.objects[0]);else var b=new fabric.Circle(c.objects[0]);b.render(a)}}else wpStamp.canvas.clipTo=null},loadProducts:function(){$.ajax({xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;wpStamp.progressBar(b)}}),a},type:"POST",url:fa_settings.site_url_,data:{action:"get_other_parent_products"},beforeSend:function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/json;charset=UTF-8")},success:function(a){var b=$(".amount").html(),c=b[0];if(0!=a.length){var d=$("#product-changer");$.each(a,function(a,b){active=Number(a)==Number($("#tshirtFacing").attr("data-id"))?"active other-product":"not other-product",d.append('<li class="'+active+'"><a data-id="'+a+'" href="#"><span class="product-single-price">'+c+b.price+'</span><img class="img" alt="'+b[2]+'" src="'+b[0]+'"/></a></li>'),wpStamp.allProducts[a]=b})}},error:function(){}})},changeProduct:function(a){var b=$(".designer-container, .t-container"),c=($("#drawingArea"),$("#tcanvas")),d=$(".amount").html(),e="";$(".product-list").html("No variations"),$.each(wpStamp.allProducts[a].variations,function(a,b){e+='<li class="colors"><a data-front="'+b[0]+'" data-back="'+b[1]+'"  title="'+b[2]+'" class="colors"><img src="'+b[0]+'"/><div class="product-name">'+b[2]+' <span class="color-box" style="background:'+b[3]+';"></span> </div></a></li>'}),$(".product-list").html(e),b.attr("data-width",wpStamp.allProducts[a].info.width_pixels),b.attr("data-height",wpStamp.allProducts[a].info.height_pixels),$("#tshirtFacing").attr("data-front",""),$("#tshirtFacing").attr("data-back",""),$("#tshirtFacing").attr("data-id",a);try{var f=wpStamp.allProducts[a].info.real_paint_a.split("/"),g=""!=wpStamp.allProducts[a].info.real_paint_b?wpStamp.allProducts[a].info.real_paint_b.split("/"):"",h=""!==f[0]?JSON.parse(f):"",i=g?JSON.parse(g):"";if(""==wpStamp.allProducts[a].variations[0][1]?$("#flip").hide():$("#flip").show(),""!==h){var j=h.objects[0].width*h.objects[0].scaleX,k=h.objects[0].height*h.objects[0].scaleY,l=h.objects[0].left,m=h.objects[0].top;$(".adl-price").val(wpStamp.allProducts[a].info.price_back),$(".real-price").val(wpStamp.allProducts[a].price),$(".amount").html(wpStamp.allProducts[a].price),$(".amount").prepend(d[0]),c.attr("data-width",j),c.attr("data-height",k),c.attr("data-top",m),c.attr("data-left",l),c.attr("data-shape",wpStamp.allProducts[a].info.real_paint_a)}else c.attr("data-width",""),c.attr("data-height",""),c.attr("data-top",""),c.attr("data-left",""),c.attr("data-shape","");if(""!==i){var n=i.objects[0].width*i.objects[0].scaleX,o=i.objects[0].height*i.objects[0].scaleY,p=i.objects[0].left,q=i.objects[0].top;c.attr("data-widthb",n),c.attr("data-leftb",p),c.attr("data-heightb",o),c.attr("data-topb",q),c.attr("data-shapeb",wpStamp.allProducts[a].info.real_paint_b)}else c.attr("data-shapeb",""),c.attr("data-widthb",""),c.attr("data-leftb",""),c.attr("data-heightb",""),c.attr("data-topb","")}catch(r){}$(".frontside,.backside,.helper,#drawingArea").css({width:wpStamp.allProducts[a].info.width_pixels+"px",height:wpStamp.allProducts[a].info.height_pixels+"px"}),$(".frontside,.backside,.helper,#drawingArea").attr({"data-width":wpStamp.allProducts[a].info.width_pixels,"data-height":wpStamp.allProducts[a].info.height_pixels}),$("#backgrounds a").eq(0).click();$(".t-container").attr("data-width"),$(".t-container").attr("data-height");wpStamp.resetShape()},drawStar:function(a,b,c,d,e,f,g){var h=Math.PI/a;f.fillStyle=g,f.beginPath();for(var i=0;2*a>i;i++){var j=1&i?e:d,k=b+Math.cos(i*h)*j,l=c+Math.sin(i*h)*j;i?f.lineTo(k,l):f.moveTo(k,l)}f.closePath(),f.fill()},textPlugin:{convert:function(){var a=wpStamp.canvas,b="arc",c={},d=a.getActiveObject(),e=$(".convert"),f=e.attr("data-collapse");if(d){if(/curvedText/.test(d.type)){default_text=d.getText(),c=d.toObject(),delete c.type,c.clipName="all";var g=new fabric.Text(default_text,c);$("#"+f).show(),e.removeClass("actived")}else if(/text/.test(d.type)){default_text=d.getText(),c=d.toObject(),delete c.type,c.textAlign="center",c.radius=120,c.spacing=10,c.effect=b,c.clipName="all",$("#"+f).hide(),e.addClass("actived");var g=new fabric.CurvedText(default_text,c)}a.remove(d),$("#layers").find("li#"+d.id).remove(),a.add(g),a.setActiveObject(a.item(a.getObjects().length-1)),d.setCoords(),a.calcOffset(),wpStamp.renderCanvas()}},add:function(a){var b=wpStamp.canvas;if(""==a);else{var c=wpStamp.canvas.width/2,d=wpStamp.canvas.height/2,e=new fabric.Text(a,{left:c,top:d,angle:0,clipName:"all",lineHeight:"1"});e.set("fontFamily",$("#font-family").val().replace(/\+/g," ")?$("#font-family").val().replace(/\+/g," "):"Arial"),$("#text-string").css("font-family",$("#font-family").val().replace(/\+/g," ")),e.fill=wpStamp.getCurrentColor(),b.add(e),wpStamp.canvas.calcOffset(),e.center().setCoords(),wpStamp.renderCanvas(),1==wpStamp.mobile&&($(".static").removeClass("collapse"),$(".my-tools").removeClass("animated slideOutLeft").addClass("animated slideInLeft"),$(".panels").removeClass("animated slideOutRight").addClass("animated slideInRight hide"))}},load:function(){var a=wpStamp.canvas;$(".convert").on("click",function(){wpStamp.textPlugin.convert()}),$("#reverse")[0].noUiSlider.on("slide",function(b){var c=a.getActiveObject();if(c){var d=parseInt(b)>0?!0:!1;c.set("reverse",d),wpStamp.renderCanvas()}}),$("#reverse")[0].noUiSlider.updateOptions({start:0,range:{min:[0,1],max:1}}),$("#radius")[0].noUiSlider.on("slide",function(b){var c=a.getActiveObject();c&&(c.set("radius",parseInt(b)),wpStamp.canvas.calcOffset(),c.setCoords()),wpStamp.renderCanvas()}),$("#spacing")[0].noUiSlider.on("slide",function(b){var c=a.getActiveObject();c&&(c.set("spacing",parseInt(b)),wpStamp.canvas.calcOffset(),c.setCoords()),wpStamp.renderCanvas()}),$("#add-text").on("click",function(){wpStamp.textPlugin.add($("#text-string").val()),$("#text-string").val("")}),$("#text-string").keyup(function(){$("#add-text").removeData("data-tooltip");var a=wpStamp.canvas.getActiveObject();!a||"text"!==a.type&&"curvedText"!==a.type||(a.setText(this.value),a.setCoords(),wpStamp.renderCanvas())}),$("#line-height").click(function(){var b=Math.abs(parseInt($(this).prev("input").val()))?Math.abs(parseInt($(this).prev("input").val())):"2",c=a.getActiveObject();
c&&"text"===c.type&&(c.lineHeight=b/10,c.setCoords(),wpStamp.renderCanvas())}),$("#line-height-input").change(function(){var b=Math.abs(parseInt($(this).val()))?Math.abs(parseInt($(this).val())):"2",c=a.getActiveObject();c&&"text"===c.type&&(c.lineHeight=b/10,c.setCoords(),wpStamp.renderCanvas())}),$("body").on("click",".text-formating a",function(){var b=a.getActiveObject(),c=$(this).attr("data-type"),d=$(this).attr("data-value");b&&"text"===b.type&&($(this).toggleClass("active"),"fontWeight"==c?b.fontWeight=b.fontWeight==d?"":d:"fontStyle"==c?b.fontStyle=b.fontStyle==d?"":d:b.textDecoration=b.textDecoration==d?"":d,wpStamp.renderCanvas())}),$("body").on("click",".text-aligning a",function(){var b=a.getActiveObject(),c=$(this).attr("data-value");b&&"text"===b.type&&($(".text-aligning a").removeClass("active"),$(this).toggleClass("active"),b.set("textAlign",c),wpStamp.renderCanvas())}),$("#font-family").fontselect().change(function(){var a=$(this).val().replace(/\+/g," ");wpStamp.textPlugin.setFont(a)})},setFont:function(a){var b=wpStamp.canvas.getActiveObject();!b||"text"!==b.type&&"curvedText"!==b.type||(b.set("fontFamily",a),wpStamp.canvas.calcOffset(),b.setCoords(),wpStamp.renderCanvas(),wpStamp.canvas.calcOffset())}},renderCanvas:function(){wpStamp.canvas.calcOffset().renderAll()},paintPlugin:{moveLine:function(a){var b=wpStamp.canvas,c=wpStamp.line;if(1==wpStamp.drawline){if(!wpStamp.isDown)return;var d=b.getPointer(a.e);c.set({x2:d.x,y2:d.y}),c.setCoords(),wpStamp.renderCanvas()}},startLine:function(a){var b=wpStamp.canvas;if(1==wpStamp.drawline){b.selectable=!1,wpStamp.isDown=!0;var c=b.getPointer(a.e),d=[c.x,c.y,c.x,c.y];wpStamp.line=new fabric.Line(d,{strokeWidth:$("#drawing-line-width")[0].noUiSlider.get(),fill:$("#main-color").minicolors("value"),stroke:$("#main-color").minicolors("value"),originX:"center",originY:"center"}),b.add(wpStamp.line),wpStamp.line.setCoords(),wpStamp.renderCanvas()}},load:function(){var a=$(".freedraw"),b=$(".drawing-mode-selector"),c=$("#drawing-line-width"),d=wpStamp.canvas;d.freeDrawingCursor='url("../wp-content/plugins/wpstamp/public/img/brush.png") 5 40 , default';var e=new fabric.PatternBrush(d);e.getPatternSrc=function(){var a=fabric.document.createElement("canvas");a.width=a.height=10;var b=a.getContext("2d");return b.strokeStyle=this.color,b.lineWidth=5,b.beginPath(),b.moveTo(0,5),b.lineTo(10,5),b.closePath(),b.stroke(),a};var f=new fabric.PatternBrush(d);f.getPatternSrc=function(){var a=fabric.document.createElement("canvas");a.width=a.height=10;var b=a.getContext("2d");return b.strokeStyle=this.color,b.lineWidth=5,b.beginPath(),b.moveTo(5,0),b.lineTo(5,10),b.closePath(),b.stroke(),a};var g=new fabric.PatternBrush(d);g.getPatternSrc=function(){var a=10,b=2,c=fabric.document.createElement("canvas");c.width=c.height=a+b;var d=c.getContext("2d");return d.fillStyle=this.color,d.fillRect(0,0,a,a),c};var h=new fabric.PatternBrush(d);h.getPatternSrc=function(){var a=10,b=5,c=fabric.document.createElement("canvas"),d=new fabric.Rect({width:a,height:a,angle:45,fill:this.color}),e=d.getBoundingRectWidth();c.width=c.height=e+b,d.set({left:e/2,top:e/2});var f=c.getContext("2d");return d.render(f),c},b.on("click",function(){var a=$(this).attr("data-type");b.removeClass("actived"),$(this).addClass("actived"),"hline"===a?(d.freeDrawingBrush=e,d.freeDrawingBrush.color=wpStamp.getCurrentColor(),d.freeDrawingBrush.width=0==parseInt(c[0].noUiSlider.get())?1:parseInt(c[0].noUiSlider.get())):"vline"===a?(d.freeDrawingBrush=f,d.freeDrawingBrush.color=wpStamp.getCurrentColor(),d.freeDrawingBrush.width=0==parseInt(c[0].noUiSlider.get())?1:parseInt(c[0].noUiSlider.get())):"square"===a?(d.freeDrawingBrush=g,d.freeDrawingBrush.color=wpStamp.getCurrentColor(),d.freeDrawingBrush.width=0==parseInt(c[0].noUiSlider.get())?1:parseInt(c[0].noUiSlider.get())):"diamond"===a?(d.freeDrawingBrush=h,d.freeDrawingBrush.color=wpStamp.getCurrentColor(),d.freeDrawingBrush.width=0==parseInt(c[0].noUiSlider.get())?1:parseInt(c[0].noUiSlider.get())):"texture"===a?(d.freeDrawingBrush=texturePatternBrush,d.freeDrawingBrush.color=wpStamp.getCurrentColor(),d.freeDrawingBrush.width=0==parseInt(c[0].noUiSlider.get())?1:parseInt(c[0].noUiSlider.get())):(d.freeDrawingBrush=new fabric.PencilBrush(d),d.freeDrawingBrush.color=wpStamp.getCurrentColor(),d.freeDrawingBrush.width=0==parseInt(c[0].noUiSlider.get())?1:parseInt(c[0].noUiSlider.get()))}),a.on("click",function(){d.isDrawingMode=!d.isDrawingMode,d.freeDrawingBrush.color=wpStamp.getCurrentColor(),d.freeDrawingBrush.width=0==parseInt(c[0].noUiSlider.get())?1:parseInt(c[0].noUiSlider.get()),d.isDrawingMode?($("#drawing-mode-brush").addClass(" animated fadeIn"),wpStamp.clearOther(),$(".color-secondary").parent().addClass("disabled"),$(this).addClass("active"),$(".line-draw").show()):(wpStamp.clearOther(),$(".color-secondary").parent().removeClass("disabled"),$(this).removeClass("active"),$(".line-draw").hide())}),$("#paint-tools .rect").on("click",function(){wpStamp.clearOther(),wpStamp.canvas.isDrawingMode&&(wpStamp.canvas.isDrawingMode=!1);var a=d.height/2-100,b=d.width/2-50,c=new fabric.Rect(wpStamp.defaultArray(a,b,100,100));c.fill=wpStamp.getCurrentColor(),d.add(c),d.renderAll()}),$("#paint-tools .triangle").on("click",function(){wpStamp.clearOther(),wpStamp.canvas.isDrawingMode&&(wpStamp.canvas.isDrawingMode=!1);var a=d.height/2-100,b=d.width/2-50,c=new fabric.Triangle(wpStamp.defaultArray(a,b,100,100));c.fill=wpStamp.getCurrentColor(),d.add(c),d.renderAll()}),$("#paint-tools .poly a").on("click",function(){wpStamp.clearOther(),wpStamp.canvas.isDrawingMode&&(wpStamp.canvas.isDrawingMode=!1);for(var a=d.height/2-100,b=d.width/2-50,c=new Array,e=parseInt($(this).prev("input").val())>3&&parseInt($(this).prev("input").val())?parseInt($(this).prev("input").val()):"5",f=25,g=25,h=100,i=1;e>=i;i+=1)c.push({x:f+h*Math.cos(2*i*Math.PI/e),y:g+h*Math.sin(2*i*Math.PI/e)});var j=new fabric.Polygon(c,wpStamp.defaultArray(a,b));j.fill=wpStamp.getCurrentColor(),d.add(j),wpStamp.renderCanvas()}),$("#paint-tools .line").on("click",function(){wpStamp.canvas.isDrawingMode&&(wpStamp.canvas.isDrawingMode=!1),1==wpStamp.drawline||$(this).hasClass("active")?($(this).removeClass("active"),$(".line-draw").hide(),wpStamp.drawline=!1):(0==wpStamp.drawline||void 0==wpStamp.drawline)&&(wpStamp.clearOther(),$(this).addClass("active"),$("#drawing-line-width")[0].noUiSlider.set("3"),wpStamp.drawline=!0)}),$("#paint-tools .circle").on("click",function(){wpStamp.clearOther(),wpStamp.canvas.isDrawingMode&&(wpStamp.canvas.isDrawingMode=!1);var a=d.width/2-100,b=d.height/2-100,c=new fabric.Circle({left:a,top:b,radius:50,clipName:"all"});c.fill=wpStamp.getCurrentColor(),d.add(c),d.renderAll()})}},paginate:function(a,b,c){var d=1;for($("#pagination").html("");a>=d;)$("#pagination").append(d==c?'<li class="active">'+d+"</li>":'<li><a data-name="'+b+'" data-page="'+d+'" href="#">'+d+"</a></li>"),d+=1},loadCategory:function(a,b,c){var b=b,d=a,c=c;jQuery.ajax({xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;wpStamp.progressBar(b)}},!1),a},type:"POST",dataType:"json",async:!0,url:fa_settings.site_url_,data:{category:c,page:b,posts_per_page:jQuery("#pagination").attr("data-perpage"),action:"paginate_media_gallery"},complete:function(){wpStamp.hideProgressBar()},success:function(a){var b=Math.ceil(Number(a.total)/Number(a.ppp));if(0==a.page&&(a.page+=1),"undefined"==typeof d){{var c="undefined"!==Number($(".photo-list").length)?Number($(".photo-list").length)+1:0;$("#gallery").append('<ul data-total="'+b+'" data-name="'+a.category+'" data-page="'+a.page+'" id="a'+c+'" class="photo-list"></ul>')}if(wpStamp.paginate(b,a.category,a.page),a.images.length>0){var e="";jQuery.each(a.images,function(a,b){e+='<li><img class="list-image" src="'+b.thumb+'" data-full="'+b.full+'"/></li>'}),$(".photo-list").removeClass("active"),$("#a"+c).html(e).addClass("active"),$(".photo-list,.product-list").niceScroll()}else $(".photo-list").removeClass("active"),$("#a"+c).html('<li class="nothing">Nothing found</li>').addClass("active")}else if(a.images.length>0){wpStamp.paginate(b,a.category,a.page);var e="";jQuery.each(a.images,function(a,b){e+='<li><img class="list-image" src="'+b.thumb+'" data-full="'+b.full+'"/></li>'}),$("#a"+d).html(e).addClass("active"),$(".photo-list,.product-list").niceScroll()}}})},addBackground:function(a,b,c){function d(a){$(".helper").addClass("exit"),$(".helper").prepend('   <div class="bounceball"></div><div class="message">Creating your Product</div>'),"front"==wpStamp.side&&wpStamp.flip(!0),wpStamp.canvas.setOverlayImage(f[0],function(){wpStamp.canvas.renderAll.bind(e),$(".flipper").hide(),wpStamp.canvas.loadFromJSON(wpStamp.a,function(){wpStamp.holders[0]=e.toDataURL("jpg",1),wpStamp.flip(!0),wpStamp.canvas.setOverlayImage(f[1],function(){wpStamp.canvas.renderAll.bind(e),wpStamp.canvas.loadFromJSON(wpStamp.b,function(){wpStamp.holders[1]=e.toDataURL("jpg",1),wpStamp.sendAjax(wpStamp.$color,type="",wpStamp.holders[0],wpStamp.holders[1],b,c)})}.bind(e),{globalCompositeOperation:"destination-over",meetOrSlice:"slice",backgroundImageOpacity:1,width:e.width,height:e.height,clipTo:null})})}.bind(e),{globalCompositeOperation:"destination-over",meetOrSlice:"slice",backgroundImageOpacity:1,width:e.width,height:e.height,clipTo:null})}var b=b,c=c,e=wpStamp.canvas,f=[$(".frontside img").attr("src"),$(".backside img").attr("src")];d(f)},order:function(){var a=wpStamp.canvas,b=JSON.stringify(a),c=JSON.parse(b);if(wpStamp.a||wpStamp.b||0!=c.objects.length){var d,e;"back"==wpStamp.side?(wpStamp.a=JSON.stringify(a),wpStamp.b||(wpStamp.b='{"objects":""}')):"front"==wpStamp.side&&(wpStamp.a||(wpStamp.a='{"objects":""}'),wpStamp.b=JSON.stringify(a)),JSON.parse(wpStamp.a).objects.length>0&&JSON.parse(wpStamp.b).objects.length>0&&0!=wpStamp.hasback?(a.deactivateAll().renderAll(),d=JSON.stringify(wpStamp.a),e=JSON.stringify(wpStamp.b),wpStamp.$color=a.backgroundColor,wpStamp.addBackground("12",d,e)):(wpStamp.$color=a.backgroundColor,wpStamp.a&&JSON.parse(wpStamp.a).objects.length>0?(d=JSON.stringify(wpStamp.a),e="",a.loadFromJSON(wpStamp.a,function(){a.deactivateAll().renderAll(),wpStamp.addBackground("1",d,e)})):wpStamp.b&&JSON.parse(wpStamp.b).objects.length>0&&(e=JSON.stringify(wpStamp.b),d="",a.loadFromJSON(wpStamp.b,function(){a.deactivateAll().renderAll(),wpStamp.addBackground("2",d,e)})))}else $(this).html('<em class="material-icons">info</em>Nothing to Create'),setTimeout(function(){$("#orderit-ajax").html('<em class="material-icons">shopping_cart</em>Create Product')},1e3)},clickControllers:function(){$("#zoomin").on("click",function(){wpStamp.zoomIn()}),$("#zoomout").on("click",function(){wpStamp.zoomOut()}),jQuery("body").on("click","#gallery .gallery-nav li a",function(a){a.preventDefault();var b=$(this).attr("data-list"),c=$("#gallery").find("#a"+b);if(0!==c.length)$(".gallery-nav li a").removeClass("active"),$(this).addClass("active"),$(".photo-list").removeClass("active"),c.addClass("active"),wpStamp.paginate(c.attr("data-total"),c.attr("data-name"),c.attr("data-page")),console.log(c.attr("data-total"),c.attr("data-name"),c.attr("data-page"));else{var d=$(this).attr("data-page")?$(this).attr("data-page"):0,e=$(this).attr("data-name");$(".gallery-nav li a").removeClass("active"),$(this).addClass("active"),wpStamp.loadCategory(void 0,d,e)}}),jQuery("body").on("click","#pagination li a",function(a){a.preventDefault();var b=$("#gallery").find(".photo-list.active").attr("id").split("a")[1],c=$("#gallery").find("#a"+b),d=$(this).attr("data-page")?$(this).attr("data-page"):0;c.attr("data-page",d);var e=$(this).attr("data-name");$("#pagination li a").removeClass("active"),$(this).addClass("active"),wpStamp.loadCategory(b,d,e)}),jQuery("body").on("click","#facebook",function(){wpStamp.facebook()}),jQuery("body").on("click","#instagram",function(){wpStamp.instagram()}),$(".goback").on("click",function(){$("#accorde > h3").removeClass("bye"),$(this).parent().removeClass("visible")}),$("img").on("dragstart",function(a){a.preventDefault()}),$("body").on("click",".user-list li .close",function(){var a=$(this),b=a.prev().attr("data-id");a.parent().addClass("animated zoomOut"),setTimeout(function(){a.parent().remove(),0==$(".user-list").size()},800),jQuery.ajax({type:"POST",dataType:"json",async:!0,url:fa_settings.site_url_,data:{id:b,action:"fa_delete_attachment"},success:function(a){1==a.success&&$(this).parent().remove()}})}),$("#orderit-ajax").click(function(a){a.preventDefault(),wpStamp.order()}),$(".dropdown > span").on("click",function(){$("ul.sub-menu").removeClass("visible"),$(this).hasClass("open")?($(this).removeClass("visible"),$(this).prev().removeClass("open")):($(this).removeClass("open"),$(this).next("ul.sub-menu").addClass("visible"))}),$(document).mouseup(function(a){var b=$("ul.sub-menu");b.is(a.target)||0!==b.has(a.target).length||(b.removeClass("visible"),b.prev().removeClass("open"))}),$("#main-color").minicolors({inline:!0,opacity:!0,swatches:$(this).attr("data-swatches")?$(this).attr("data-swatches").split(","):[],change:function(a,b){var c=wpStamp.canvas.getActiveObject();$("span.color-main").parent().css({"background-color":this.value,color:wpStamp.invertColor(this.value)}),c&&"path"!==c.type?(c.set("fill",this.value),c.set("opacity",b)):c&&(c.set("stroke",this.value),c.set("fill",b)),wpStamp.canvas.isDrawingMode&&(wpStamp.canvas.freeDrawingBrush.color=this.value),c&&"image"==c.type&&c.set("opacity",b),c&&c.setCoords(),wpStamp.renderCanvas()}}),$("#stroke-color").minicolors({inline:!0,swatches:$(this).attr("data-swatches")?$(this).attr("data-swatches").split(","):[],change:function(){var a=wpStamp.canvas.getActiveObject();$("span.color-secondary").parent().css({"background-color":this.value,color:wpStamp.invertColor(this.value)}),a&&(a.set("stroke",this.value),a.setCoords(),wpStamp.renderCanvas())}}),wpStamp.sliders=document.getElementsByClassName("slider");var a=0;for(a=0;a<wpStamp.sliders.length;a++)noUiSlider.create(wpStamp.sliders[a],{start:0,orientation:"horizontal",range:{min:0,max:50}});$("#drawing-line-width")[0].noUiSlider.on("slide",function(a){var b=parseInt(a);linewidth=b,wpStamp.canvas.freeDrawingBrush.width=parseInt(linewidth,10)||1}),$("#border-line-width")[0].noUiSlider.on("slide",function(a){var b=parseInt(a),c=wpStamp.canvas.getActiveObject();if(c){var d=""==$("#stroke-color").minicolors("value")?"#555555":$("#stroke-color").minicolors("value");if(c.set("stroke",d),0==b)c.set("stroke",null),c.set("strokeWidth","");else{var e="text"==c.type?.05*b:b;c.set("strokeWidth",e)}c.setCoords(),wpStamp.renderCanvas()}}),$("#radius")[0].noUiSlider.updateOptions({range:{min:10,max:400}},!0),$("#spacing")[0].noUiSlider.updateOptions({range:{min:0,max:40}},!0),$("#layer-trigger").on("click",function(a){a.preventDefault(),$(this).toggleClass("active"),$(this).hasClass("active")?$("#layers").addClass("show"):($("#layers").removeClass("show"),$(this).blur())}),$(".designer-container h1").on("click",function(a){a.preventDefault();var b=$(this).children("a").text(),c=$(this).attr("data-collapse");$(this).parent().removeClass("animated slideInRight").addClass("animated slideOutLeft"),$(this).parent().parent().next().removeClass("hide").removeClass("animated slideOutRight").addClass("animated slideInRight"),setTimeout(function(){$("#"+c).addClass("collapse")},10),$("#"+c).children(".heading").html("<button class='back-menu'><em class='material-icons'>close</em></button><h2>"+b+"</h2>")}),$("body").on("click",".heading > .back-menu",function(a){a.stopPropagation(),a.preventDefault();var b=$(this);$(".designer-container .my-tools").removeClass("amimated slideOutLeft").addClass("animated slideInLeft"),$(".designer-container .panels").removeClass("animated slideInRight").addClass(" animated slideOutRight"),setTimeout(function(){b.parent().parent().removeClass("collapse")},500)}),fa_settings.edit_id&&wpStamp.ajax_load(fa_settings.edit_id),$(".tool-container").on("mouseover",function(){$(".tool-container").removeClass("closeme"),$(this).data("close","0")}),$("#crop").on("click",function(){wpStamp.crop()}),$(".handle").on("click",function(){$(".tools").toggleClass("mobile")}),this.loadMediaCategories(),this.extraTools()},crop:function(){var a=wpStamp.canvas,b=a.getActiveObject();if(b&&"image"==b.type){var c=b.getAngle(),d={scaleY:b.getScaleY(),scaleX:b.getScaleX()},e={top:b.top,left:b.left};htmlelement=b._originalElement,$(".fa-modal").addClass("show"),htmlelement.id="target",$("#crop-image").html(htmlelement);var f=new Darkroom("#target",{minWidth:100,minHeight:100,maxWidth:600,maxHeight:500,plugins:{save:!0,save:{callback:function(){var a=wpStamp.canvas;this.darkroom.selfDestroy();var g=f.canvas.toDataURL();fileStorageLocation=g,a.remove(b),$(".fa-modal").removeClass("show"),fabric.Image.fromURL(g,function(b){b.set({angle:c,top:e.top,left:e.left,scaleX:d.scaleX,scaleY:d.scaleY}),a.add(b)})}},crop:{quickCropKey:67}},initialize:function(){}})}},loadMediaCategories:function(a){var a="undefined"==typeof a?$("#tshirtFacing").attr("data-id"):a;jQuery.ajax({xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;wpStamp.progressBar(b)}},!1),a},type:"POST",dataType:"json",url:fa_settings.site_url_,data:{action:"show_images",id:a},complete:function(){wpStamp.hideProgressBar()},success:function(a){var b="";a&&($.each(a,function(a,c){b+='<li><a data-list="'+(a+2)+'" data-name="'+c.name+'" data-cat="'+c.id+'" href="#'+c.name+'">'+c.name+"</a></li>"}),$("#gallery .gallery-nav").prepend(b),$("#gallery .gallery-nav").prepend("<li class='prev'><em class='material-icons'>keyboard_arrow_left</em></li>"),$("#gallery .gallery-nav").append("<li class='next'><em class='material-icons'>keyboard_arrow_right</em></li>"),$("#gallery .gallery-nav").simplecarousel({next:$(".next"),prev:$(".prev"),auto:!1,visible:2,width:$(".panels").width()/2-50}),$(".photo-list,.product-list").niceScroll(),$("#gallery .gallery-nav li a").eq(0).click())}})},extraTools:function(){var a=wpStamp.canvas;$("#return").on("click",function(a){a.preventDefault(),$("#my-gallery .gallery-nav").hide(),$("#my-gallery .upload-nav, #my-gallery .user-list").addClass("hidden"),$(".selection-user-list").show()}),fabric.util.removeListener(a.upperCanvasEl,"dblclick",wpStamp.dblClickHandler);var b=function(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""};$("#main-color-tool,#border-color-tool").on("click",function(b){b.preventDefault(),wpStamp.mainColorTool="main-color-tool"==$(this).attr("id")?1:2,a.defaultCursor="crosshair",a.selection=!1,a.forEachObject(function(a){a.selectable=!1})}),$("canvas").on("mousemove",function(c){if(wpStamp.mainColorTool>0){ctx=a.getContext();var d=ctx.getImageData(c.offsetX,c.offsetY,1,1).data;a.defaultCursor="crosshair",1==wpStamp.mainColorTool?$("#main-color").minicolors("value",b("rgba("+d.join(",")+")")):2==wpStamp.mainColorTool&&$("#stroke-color").minicolors("value",b("rgba("+d.join(",")+")"))}}),$("canvas").on("click",function(c){if(wpStamp.mainColorTool>0){ctx=a.getContext();var d=ctx.getImageData(c.offsetX,c.offsetY,1,1).data;a.defaultCursor="default",1==wpStamp.mainColorTool?$("#main-color").minicolors("value",b("rgba("+d.join(",")+")")):2==wpStamp.mainColorTool&&$("#stroke-color").minicolors("value",b("rgba("+d.join(",")+")")),wpStamp.mainColorTool=0,a.defaultCursor="default",a.selection=!0,a.forEachObject(function(a){a.selectable=!0})}}),$("body").on("click",".user-list img, .photo-list img",function(){var a=$(this).data("full"),b=a.split(".").pop();"svg"==b?wpStamp.addSvg(a):wpStamp.addImage(a),1==wpStamp.mobile&&($(".static").removeClass("collapse"),$(".my-tools").removeClass("animated slideOutLeft").addClass("animated slideInLeft"),$(".panels").removeClass("animated slideOutRight").addClass("animated slideInRight hide"))}),$(".other-custom").on("click",function(){var a=$(this).children("a").attr("rel");wpStamp.ajax_load_parent(a)}),$("body").on("click",".remove-selected",function(){wpStamp.removeSelected()}),$("body").on("click",".bring-to-front",function(){var b=a.getActiveObject(),c=a.getActiveGroup();if(b)b.bringToFront();else if(c){var d=c.getObjects();a.discardActiveGroup(),d.forEach(function(a){a.bringToFront()})}else{var e=wpStamp.getObjectById($(this).parent().parent().attr("data-id"));wpStamp.canvas.bringToFront(e)}var f=$(this).parent().parent().index();f>0&&$("#layers li:eq("+f+")").after($("#layers li:eq("+(f-1)+")"))}),$("body").on("click",".send-to-back",function(){console.info("dojk");var b=a.getActiveObject(),c=a.getActiveGroup();if(b)b.sendToBack(),console.log("SENDED");else if(c){var d=c.getObjects();a.discardActiveGroup(),d.forEach(function(a){a.sendToBack()})}else try{var e=wpStamp.getObjectById($(this).parent().parent().attr("data-id"));wpStamp.canvas.sendToBack(e)}catch(f){}var g=$(this).parent().parent().index();g<$("ul#layers").size()&&$("#layers li:eq("+g+")").before($("#layers li:eq("+(g+1)+")"))}),$("#upload-input").on("change",function(a){wpStamp.handleFiles(a)}),$("#user-library").on("click",function(){var a=$(this);$("#my-gallery").has("#user-list").length>0?($(".selection-user-list").hide(),$(".upload-nav").removeClass("hidden"),$("#my-gallery #user-list").removeClass("hidden")):(a.html('<em class="material-icons">error</em>Please upload an image'),setTimeout(function(){a.html('<em class="material-icons">photo_library</em>My Library')},1e3))});for(var c=document.querySelectorAll(".photo img"),d=null,e=0;e<c.length;e++)d=c[e],d.setAttribute("draggable","true"),wpStamp.addEvent(d,"dragstart",function(a){a.dataTransfer.effectAllowed="copy",a.dataTransfer.setData("Text",this.src)});var f=document.querySelector(".inner-wrapper");wpStamp.addEvent(f,"dragover",function(a){return a.preventDefault&&a.preventDefault(),this.className="over",a.dataTransfer.dropEffect="copy",!1}),wpStamp.addEvent(f,"dragenter",function(){return this.className="",!1}),wpStamp.addEvent(f,"dragleave",function(){this.className=""}),wpStamp.addEvent(f,"drop",function(a){if(a.stopPropagation&&a.stopPropagation(),this.className="",a.stopPropagation(),a.preventDefault(),a.dataTransfer.files[0])wpStamp.handleFiles(a.dataTransfer.files[0],!0);else{var b=a.dataTransfer.getData("Text");wpStamp.dropthat(b,a.clientX-140,a.clientY-140)}return!1}),$("#flip").on("click",function(){$(this).toggleClass("hover"),wpStamp.flip(!1)}),$("#redo").on("click",function(){}),$("#undo").on("click",function(){})},variationPlugin:{load:function(){$("body").on("click","#backgrounds a",function(a){a.preventDefault(),$("#backgrounds li").removeClass("selected"),$(this).parent().toggleClass("selected");var b=$(this).data("front"),c=$(this).data("back"),d=($(this).data("id"),$(".flipper > .t-container").css("width"),$(".flipper > .t-container").css("height"),'<img src="'+b+'"/>'),e='<img src="'+c+'"/>';$(".t-container.frontside").html(d),$(".t-container.backside").html(e),$("#backgrounds").css("background-color",$(this).css("background-color")),$("#tshirtFacing").data("front",b),$("#tshirtFacing").data("back",c)})}},updateModifications:function(){},onObjectAdded:function(a){var b=wpStamp.canvas.getObjects().length-1;"image"==a.target.type&&(icon="image"),"text"==a.target.type&&(icon="font_download"),icon="path"==a.target.type?"timeline":"crop_landscape",0==wpStamp.isDown&&"line"!==a.target.type&&"all"!=a.target.clipFor&&(a.target.set("id",b),wpStamp.canvas.renderAll(),wpStamp.layersPlugin.add(b,icon,a.target.type)),wpStamp.checkPrice()},undo:function(){wpStamp.mods<wpStamp.state.length&&(wpStamp.canvas.clear().renderAll(),wpStamp.canvas.loadFromJSON(wpStamp.state[wpStamp.state.length-1-wpStamp.mods-1],wpStamp.canvas.renderAll.bind(wpStamp.canvas)),wpStamp.canvas.renderAll(),console.log("state "+wpStamp.state.length),wpStamp.mods+=1)},redo:function(){wpStamp.mods>0&&(wpStamp.canvas.clear().renderAll(),wpStamp.canvas.loadFromJSON(wpStamp.state[wpStamp.state.length-1-wpStamp.mods+1],wpStamp.canvas.renderAll.bind(wpStamp.canvas)),wpStamp.canvas.renderAll(),wpStamp.mods-=1)},clearOther:function(){$(".freedraw");$(".color-secondary").parent().removeClass("disabled"),wpStamp.drawline=!1,$(".line-draw").hide(),$("#paint-tools a").removeClass("active")},zoomIn:function(){var a=wpStamp.canvas,b=10,c=a.getZoom()+b/300<=1?1:a.getZoom()+b/300;wpStamp.zoom=c,a.zoomToPoint({x:wpStamp.canvas.getWidth()/2,y:wpStamp.canvas.getHeight()/2},c),wpStamp.renderCanvas(),$(".t-container").css({top:a.viewportTransform[4]+"px",left:a.viewportTransform[5]+"px",width:a.getWidth()*a.getZoom()+"px",height:a.getHeight()*a.getZoom()+"px"}),wpStamp.realArea(a.getZoom()),wpStamp.renderCanvas()},zoomCanvas:function(){wpStamp.canvas},applyFilter:function(a,b){var c=canvas.getActiveObject();c.filters[a]=b,c.applyFilters(canvas.renderAll.bind(canvas))},applyFilterValue:function(a,b,c){var d=canvas.getActiveObject();d.filters[a]&&(d.filters[a][b]=c,d.applyFilters(canvas.renderAll.bind(canvas)))},zoomOut:function(){var a=wpStamp.canvas,b=-100,c=a.getZoom()+b/300<=1?1:a.getZoom()+b/300;wpStamp.zoom=c,a.zoomToPoint({x:wpStamp.canvas.getWidth()/2,y:wpStamp.canvas.getHeight()/2},c),wpStamp.renderCanvas(),$(".t-container").css({top:a.viewportTransform[4]+"px",left:a.viewportTransform[5]+"px",width:a.getWidth()*a.getZoom()+"px",height:a.getHeight()*a.getZoom()+"px"}),wpStamp.realArea(a.getZoom()),wpStamp.renderCanvas()},flip:function(a){var b=wpStamp.canvas,a="undefined"==typeof a?"false":a;if($("#layers").html('<li class="nothing">No layers</li>'),wpStamp.checkPrice(),1==wpStamp.hasback)if("back"==wpStamp.side){$("#flip").attr("data-original","front"),wpStamp.side="front",wpStamp.realArea(),wpStamp.a=JSON.stringify(b),0==a&&$("#tshirtFacing").addClass("flip"),b.clear(),wpStamp.renderCanvas();try{{JSON.parse(wpStamp.b)}b.loadFromJSON(wpStamp.b),wpStamp.renderCanvas()}catch(c){}wpStamp.renderCanvas(),setTimeout(function(){wpStamp.renderCanvas()},200)}else{0==a&&$("#tshirtFacing").removeClass("flip"),$("#flip").attr("data-original","back"),wpStamp.side="back",wpStamp.realArea(),wpStamp.b=JSON.stringify(b),b.clear(),wpStamp.renderCanvas();try{{JSON.parse(wpStamp.a)}b.loadFromJSON(wpStamp.a),wpStamp.renderCanvas()}catch(c){console.log(c)}wpStamp.renderCanvas(),setTimeout(function(){wpStamp.renderCanvas()},200)}else{$("#flip").attr("data-original","front"),wpStamp.side="front",wpStamp.a=JSON.stringify(b),0==a&&$("#tshirtFacing").addClass("flip"),b.clear(),wpStamp.renderCanvas();try{{JSON.parse(wpStamp.b)}b.loadFromJSON(wpStamp.b),wpStamp.renderCanvas()}catch(c){}wpStamp.renderCanvas(),setTimeout(function(){wpStamp.renderCanvas()},200)}},initCustomization:function(){fabric.Object.prototype.transparentCorners=!1,fabric.Object.prototype.opacity=1,fabric.Object.prototype.cornerColor=fa_settings.setting_corner_color_,fabric.Object.prototype.borderColor=fa_settings.setting_border_color_,fabric.Object.prototype.hasRotatingPoint=!1,fabric.Object.prototype.cornerSize=fa_settings.setting_corner_width_,/(iPhone|iPod|iPad)/i.test(navigator.userAgent)},hideProgressBar:function(){$(".progress-bar").removeClass("active"),$(".progress-bar").children("span").css("width",0)},progressBar:function(a){$(".progress-bar").hasClass("active")||$(".progress-bar").addClass("active"),$(".progress-bar > span").css("width",100*a+"%")},addLibrary:function(a,b){$("#my-gallery .selection-user-list").hide(),$("#my-gallery .gallery-nav").removeClass("active"),0==$("#my-gallery").has("#user-list").length?$("#my-gallery").append('<ul class="user-list" id="user-list"></ul>'):$("#user-list").removeClass("hidden");var c=$("#my-gallery #user-list");c.prepend('<li><img data-full="'+a+'" data-id="'+b+'" src="'+a+'" /><span class="close"><em class="material-icons">close</em></span></li>'),c.niceScroll(),$(".upload-nav").removeClass("hidden"),c.getNiceScroll().resize()},createListenersKeyboard:function(){document.onkeydown=wpStamp.onKeyDownHandler},onKeyDownHandler:function(a){var b;switch(b=window.event?window.event.keyCode:a.keyCode){case 67:wpStamp.ableToShortcut()&&a.ctrlKey&&(a.preventDefault(),copy());break;case 86:wpStamp.ableToShortcut()&&a.ctrlKey&&(a.preventDefault(),paste());break;case 46:wpStamp.ableToShortcut()&&(a.preventDefault(),wpStamp.removeSelected())}},removeSelected:function(){var a=wpStamp.canvas,b=a.getActiveObject(),c=a.getActiveGroup();if(b)a.remove(b),$("#text-string").val(""),$("#layers").find("li#"+b.id).remove();else if(c){var d=c.getObjects();a.discardActiveGroup(),d.forEach(function(b){a.remove(b),$("#layers").find("li#"+b.id).remove()})}},ableToShortcut:function(){return!0},invertColor:function(a){var b=a;return b=b.substring(1),b=parseInt(b,16),b=16777215^b,b=b.toString(16),b=("000000"+b).slice(-6),parseInt(b,16)>8388607.5?"#fff":"#111"},copy:function(){if(canvas.getActiveGroup())for(var a in canvas.getActiveGroup().objects){var b=fabric.util.object.clone(canvas.getActiveGroup().objects[a]);b.set("top",b.top+5),b.set("left",b.left+5),copiedObjects[a]=b}else if(canvas.getActiveObject()){var b=fabric.util.object.clone(canvas.getActiveObject());b.set("top",b.top+5),b.set("left",b.left+5),copiedObject=b,copiedObjects=new Array}},paste:function(){if(copiedObjects.length>0)for(var a in copiedObjects)canvas.add(copiedObjects[a]);else copiedObject&&canvas.add(copiedObject);canvas.renderAll()},handleFiles:function(a,b){if(1==b){var c=(a.name,new FileReader);c.onload=function(a){var b=new Image;b.src=a.target.result,b.onload=function(){var a=b.src,c=(a.replace(/^.*[\\\/]/,""),$("#").data("Id"));wpStamp.addLibrary(b.src,c),wpStamp.addImage(b.src)}},c.readAsDataURL(a)}else for(var d,e=a.target.files,f=0;d=e[f];f++){var c=(d.name,new FileReader);c.onprogress=function(a){if(a.lengthComputable){var b=a.loaded/a.total;wpStamp.progressBar(b)}},c.onload=function(a){request=new XMLHttpRequest,wpStamp.hideProgressBar();var b=new Image;try{b.src=a.target.result}catch(c){alert("error loading file(s)")}b.onload=function(){var a=b.src,c=(a.replace(/^.*[\\\/]/,""),$("#").data("Id"));wpStamp.addLibrary(b.src,c),wpStamp.addImage(b.src)}},c.readAsDataURL(a.target.files[f])}},dataURItoBlob:function(a){for(var b=atob(a.split(",")[1]),c=[],d=0;d<b.length;d++)c.push(b.charCodeAt(d));return new Blob([new Uint8Array(c)],{type:"image/jpeg"})},getObjectById:function(a){var b=wpStamp.canvas,c=b.getObjects();if(console.log(c),c.length>0)for(obj in c)if(c[obj]&&c[obj].get("id")==a)return c[obj]},addEvent:function(){return document.addEventListener?function(a,b,c){if(a&&a.nodeName||a===window)a.addEventListener(b,c,!1);else if(a&&a.length)for(var d=0;d<a.length;d++)wpStamp.addEvent(a[d],b,c)}:function(a,b,c){if(a&&a.nodeName||a===window)a.attachEvent("on"+b,function(){return c.call(a,window.event)});else if(a&&a.length)for(var d=0;d<a.length;d++)wpStamp.addEvent(a[d],b,c)}},getRandomNum:function(a,b){return Math.random()*(b-a)+a},onMouseUp:function(){(wpStamp.lineW||wpStamp.lineH)&&(wpStamp.canvas.remove(wpStamp.lineW),wpStamp.canvas.remove(wpStamp.lineH)),wpStamp.lineAdded=!1,wpStamp.isDown=!1,wpStamp.canvas.selectable=!0,wpStamp.canvas.renderAll()},onObjectMoving:function(){if(0==wpStamp.lineAdded){if("back"==wpStamp.side)var a=""!==$("#tcanvas").attr("data-left")?Number($("#tcanvas").attr("data-left")):0,b=""!==$("#tcanvas").attr("data-top")?Number($("#tcanvas").attr("data-top")):0,c=Number(""!==$("#tcanvas").attr("data-width")?$("#tcanvas").attr("data-width"):$("#tcanvas").width()),d=Number(""!==$("#tcanvas").attr("data-height")?$("#tcanvas").attr("data-height"):$("#tcanvas").height());else var a=""!==$("#tcanvas").attr("data-leftb")?Number($("#tcanvas").attr("data-leftb")):0,b=""!==$("#tcanvas").attr("data-topb")?Number($("#tcanvas").attr("data-topb")):0,c=Number(""!==$("#tcanvas").attr("data-widthb")?$("#tcanvas").attr("data-widthb"):$("#tcanvas").width()),d=Number(""!==$("#tcanvas").attr("data-heightb")?$("#tcanvas").attr("data-heightb"):$("#tcanvas").height());
var e=c*wpStamp.ratio/2+a*wpStamp.ratio,f=d*wpStamp.ratio/2+b*wpStamp.ratio,g=d*wpStamp.ratio+b*wpStamp.ratio,h=c*wpStamp.ratio+a*wpStamp.ratio;wpStamp.lineW=new fabric.Line([e,0,e,g],{stroke:"magenta",strokeWidth:.5,selectable:!1}),wpStamp.lineH=new fabric.Line([0,f,h,f],{stroke:"magenta",strokeWidth:.5,selectable:!1}),wpStamp.canvas.add(wpStamp.lineW),wpStamp.canvas.add(wpStamp.lineH),wpStamp.renderCanvas(),wpStamp.lineAdded=!0}},positionBtn:function(){fabric.Canvas.prototype.getAbsoluteCoords=function(a){return{left:a.left,top:a.top}};$("#moving-tools")},onSelectedCleared:function(){$(".convert").hide(),$(".material-toolbox").addClass("hidden");var a=$(".convert").attr("data-collapse");$("#"+a).hide(),$("#text-tool a").removeClass("active"),$("#text-string").val(""),$("#border-line-width")[0].noUiSlider.set([this.value,null]),$("#radius")[0].noUiSlider.set([this.value,null]),$("#spacing")[0].noUiSlider.set([this.value,null]),$("#layers").find("li").removeClass("active")},instagram:function(){function a(a,b,c){var e=700,f=500,g=(window.screen.width-e)/2,h=(window.screen.height-f)/2;console.log(fa_settings.instagram);var i=window.open(fa_settings.instagram,"","width="+e+",height="+f+",left="+g+",top="+h);i.onload=function(){0==window.location.hash.length,console.log("EEEEEEEEEEEEE"),i.open("https://instagram.com/oauth/authorize/?client_id="+a+"&redirect_uri="+b+"&response_type=token&scope=public_content","_self");var e=setInterval(function(){try{i.location.hash.length&&(clearInterval(e),d=i.location.hash.slice(14),i.close(),void 0!=c&&"function"==typeof c&&c())}catch(a){}},100)}}function b(){$.ajax({url:"https://api.instagram.com/v1/users/self/media/recent/?access_token="+d,dataType:"jsonp",cache:!1,success:function(a){if(a.data.length>0){var b="";$.each(a.data,function(a,c){b+='<li><img class="list-image" src="'+c.images.low_resolution.url+'" data-full="'+c.images.standard_resolution.url+'"/></li>'}),$(".selection-user-list").hide(),0==$("#my-gallery").has("#instagram-list").length?$("#my-gallery").append('<ul class="user-list" id="instagram-list"></ul>'):$("#instagram-list").removeClass("hidden"),$("#instagram-list").html(b),$("#instagram-list").niceScroll(),$(".upload-nav").removeClass("hidden")}}})}function c(){return a("2390264c2316499ab86af6b7295b1d73",fa_settings.instagram,b),!1}var d=null;c()},facebook:function(){var a=1,b=setInterval(function(){a+=1,wpStamp.progressBar(a)},1e3);$.getScript("//connect.facebook.net/en_US/sdk.js",function(){FB.init({appId:"161922393945949",version:"v2.5"}),$("#loginbutton,#feedbutton").removeAttr("disabled"),FB.getLoginStatus(function(a){var a=a;"connected"===a.status?($("body").on("click","#my-gallery .gallery-nav .fbc",function(){$("#my-gallery .gallery-nav .fbc").removeClass("active"),$(this).addClass("active");var b=$(this).attr("data-cat");wpStamp.fbPhoto(a,b,0,9)}),FB.api("/"+a.authResponse.userID+"/albums",function(a){if(a&&!a.error){var c="";$.each(a.data,function(a,b){c+='<li><a class="fbc" data-name="'+b.name+'" data-cat="'+b.id+'" href="#'+b.name+'">'+b.name+"</a></li>"}),clearInterval(b),wpStamp.hideProgressBar(),$("#my-gallery .gallery-nav").html(),$("#my-gallery .gallery-nav").prepend(c),$("#my-gallery .gallery-nav").prepend("<li class='prev'><em class='material-icons'>keyboard_arrow_left</em></li>"),$("#my-gallery .gallery-nav").append("<li class='next'><em class='material-icons'>keyboard_arrow_right</em></li>"),$("#my-gallery .gallery-nav").simplecarousel({next:$(".next"),prev:$(".prev"),auto:!1,visible:2,width:$(".panels").width()/2-50}),$(".upload-nav").removeClass("hidden"),$("#my-gallery .gallery-nav  a.fbc").eq(0).click()}})):FB.login(function(){},{scope:"user_photos"})})})},fbPhoto:function(a,b){var b=b,c="SELECT src_big, caption, src_small, src FROM photo WHERE owner ="+a.authResponse.userID+" AND album_object_id = "+b,d=1,e=setInterval(function(){d+=1,wpStamp.progressBar(d)},1e3);FB.api({method:"fql.query",query:c},function(a){if(console.log(a),a.length>0){var b="";$.each(a,function(a,c){b+='<li><img class="list-image" src="'+c.src_small+'" data-full="'+c.src_big+'"/></li>'}),$(".selection-user-list").hide(),0==$("#my-gallery").has("#facebook-list").length?$("#my-gallery").append('<ul class="user-list" id="facebook-list"></ul>'):$("#facebook-list").removeClass("hidden"),$("#my-gallery .gallery-nav").show(),$("#facebook-list").html(b),$("#facebook-list").niceScroll(),clearInterval(e),wpStamp.hideProgressBar()}})},updateStatusCallback:function(){try{FB.api("/me",function(a){fbinfo=new Array,fbinfo[0]=a.id,fbinfo[1]=a.first_name,fbinfo[2]=a.last_name,fbinfo[3]=a.email})}catch(a){}},onObjectSelected:function(a){var b=a.target;if($(".material-toolbox").removeClass("hidden"),b.hasRotatingPoint=!0,$("#layers").find("li.active").removeClass("active"),$("#layers").find("#"+a.target.id).addClass("active"),(b&&"text"===b.type||"curvedText"===b.type)&&($(".convert").show(),"curvedText"===b.type?($("#convert-curve").show(),$(".convert").addClass("actived"),$("#radius")[0].noUiSlider.set(parseInt(b.radius)),$("#spacing")[0].noUiSlider.set(parseInt(b.spacing))):($(".convert").removeClass("actived"),$(".toolbox").hide()),$("#text-tool a").removeClass("active"),$("#line-height").prev().val(Math.round(10*b.lineHeight)),$("#text-string").val(b.getText()),"bold"==b.fontWeight&&$("#text-bold").addClass("active"),"italic"==b.fontStyle&&$("#text-italic").addClass("active"),"line-through"==b.textDecoration&&$("#text-strike").addClass("active"),"underline"==b.textDecoration&&$("#text-underline").addClass("active"),"left"==b.textAlign?$("#text-align-left").addClass("active"):"center"==b.textAlign?$("#text-align-center").addClass("active"):"right"==b.textAlign&&$("#text-align-right").addClass("active"),b.fill&&($("#main-color").minicolors("opacity",b.opacity),$("#main-color").minicolors("value",b.fill))),b&&"path"!==b.type&&(b.fill&&"rgb(0,0,0)"!=b.fill?($("#main-color").minicolors("value",b.fill),$("#main-color").minicolors("opacity",b.opacity)):($("#main-color").minicolors("value","#555"),$("#main-color").minicolors("opacity",b.opacity)),""!=b.stroke&&"rgb(0,0,0)"!=b.fill)){{"text"==b.type?10*b.getStrokeWidth():b.getStrokeWidth()}$("#stroke-color").minicolors("value",b.stroke),$("#border-line-width")[0].noUiSlider.set(b.strokeWidth)}},defaultArray:function(a,b,c,d){return c||d?{left:b,top:a,width:c,height:d}:{left:b,top:a}},dropthat:function(a,b,c){var d=wpStamp.canvas,e=b,f=c;fabric.Image.fromURL(a,function(a){a.set(wpStamp.defaultArray(f,e)),a.setCoords(),d.add(a),a.crossOrigin="Anonymous"})},getCurrentColor:function(){return $("#main-color").minicolors()?$("#main-color").val():"#515151"},addSvg:function(a){var b=wpStamp.canvas,c=[];try{fabric.loadSVGFromURL(a,function(a,d){{var e=fabric.util.groupSVGElements(a,d);new fabric.Group(c)}e.set(wpStamp.defaultArray(100,100)),b.add(e),wpStamp.cache(),wpStamp.renderCanvas()})}catch(d){}},convertImgToDataURLviaCanvas:function(a,b,c){var d=new Image;d.crossOrigin="Anonymous",d.onload=function(){var a,d=document.createElement("CANVAS"),e=d.getContext("2d");d.height=this.height,d.width=this.width,e.drawImage(this,0,0),a=d.toDataURL(c),b(a),d=null},d.src=a},convertFileToDataURLviaFileReader:function(a,b){var c=new XMLHttpRequest;c.responseType="blob",c.onload=function(){var a=new FileReader;a.onloadend=function(){b(a.result)},a.readAsDataURL(c.response)},c.open("GET",a),c.send()},findByClipName:function(a){var b=wpStamp.canvas,c=b.getObjects();console.log(c);for(obj in c)if(c[obj].get("clipFor")==a)return c[obj]},degToRad:function(a){return a*(Math.PI/180)},clipByName:function(a,b){b.setCoords();var c=wpStamp.findByClipName(b.clipName);console.log(c);var d=1/b.scaleX,e=1/b.scaleY;a.save();{var f=-(b.width/2)+c.strokeWidth,g=-(b.height/2)+c.strokeWidth;c.width-c.strokeWidth,c.height-c.strokeWidth}a.translate(f,g),a.rotate(wpStamp.degToRad(-1*b.angle)),a.scale(d,e),a.beginPath(),a.lineWidth="1",a.strokeStyle="magenta",a.rect(c.left-b.oCoords.tl.x,c.top-b.oCoords.tl.y,c.width,c.height),a.stroke(),a.closePath(),a.restore()},addImage:function(a){if("back"==wpStamp.side){var b=Number($("#tcanvas").attr("data-left")),c=Number($("#tcanvas").attr("data-top")),d=Number($("#tcanvas").attr("data-width"));Number($("#tcanvas").attr("data-height"))}else{var b=Number($("#tcanvas").attr("data-leftb")),c=Number($("#tcanvas").attr("data-topb")),d=Number($("#tcanvas").attr("data-widthb"));Number($("#tcanvas").attr("data-heightb"))}var e=wpStamp.canvas,f=wpStamp.convertImgToDataURLviaCanvas,g="";f(a,function(a){g=a;var f=d-b;try{fabric.Image.fromURL(g,function(a){imageWidth=a.getWidth(),imageHeight=a.getHeight();var d=f/imageWidth==0?1:f/imageWidth;a.set({top:c,left:b,scaleX:imageWidth*d/imageHeight*wpStamp.ratio,scaleY:imageWidth*d/imageHeight*wpStamp.ratio}),e.add(a),a.center().setCoords(),e.renderAll()})}catch(h){}})},sendAjax:function(a,b,c,d,e,f){{var g=JSON.parse(wpStamp.b),h=JSON.parse(wpStamp.a);wpStamp.canvas}g&&0==g.objects.length&&(f=""),h&&0==h.objects.length&&(e=""),$("#orderit-ajax").html('<em class="material-icons">timer</em>Please Wait'),$.ajax({xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;wpStamp.progressBar(b)}}),a},type:"POST",dataType:"json",url:fa_settings.site_url_,data:{type:$("#tshirtFacing").data("id"),front_base:$("#tshirtFacing").data("front"),back_base:$("#tshirtFacing").data("back"),image_f:c,image_b:d,action:"create_the_product",jsonstufff:e,jsonstuffb:f},beforeSend:function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/json;charset=UTF-8")},success:function(a){1==a.success?window.location=a.message:setTimeout(function(){$("#orderit-ajax").html('<em class="material-icons">shopping_cart</em>Something Bad Happened')},1e3)},error:function(){setTimeout(function(){$("#orderit-ajax").html('<em class="material-icons">shopping_cart</em>Something Bad Happened')},1e3)}})},ajax_load:function(a){$.ajax({xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;wpStamp.progressBar(b)}},!1),a},type:"POST",dataType:"json",url:fa_settings.site_url_,data:{id:a,action:"custom_data_product"},beforeSend:function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/json;charset=UTF-8")},success:function(a){if(1==a.success){if(fontFamily=[],a.json_a){var b=$.parseJSON(a.json_a),c=b.objects;wpStamp.push_fonts(c,fontFamily)}if(a.json_b){var d=$.parseJSON(a.json_b),e=d.objects;wpStamp.push_fonts(e,fontFamily)}fontFamily.length>0?WebFont.load({google:{families:fontFamily},active:function(){wpStamp.canvas.loadFromJSON(a.json_a,function(){wpStamp.renderCanvas()}),wpStamp.a=a.json_a?a.json_a:"",wpStamp.b=a.json_b?a.json_b:""}}):(wpStamp.canvas.loadFromJSON(a.json_a,function(){wpStamp.renderCanvas()}),wpStamp.a=a.json_a?a.json_a:"",wpStamp.b=a.json_b?a.json_b:"")}},error:function(){},complete:function(){wpStamp.hideProgressBar()}})},push_fonts:function(a,b){for(var c in a){var d=a[c];for(var e in d)d.hasOwnProperty(e)&&"fontFamily"==e&&b.push(d[e])}},ajax_load_parent:function(a){$.ajax({xhr:function(){var a=new window.XMLHttpRequest;return a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=a.loaded/a.total;progressBar(b)}},!1),a},type:"POST",dataType:"json",url:fa_settings.site_url_,data:{id:a,action:"change_custom_product"},beforeSend:function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/json;charset=UTF-8")},success:function(a){1==a.success&&console.log("loaded")},error:function(){},complete:function(){hideProgressBar()}})},dblClickHandler:function(){var a=wpStamp.canvas;try{var b=a.getActiveObject(),c=a.getActiveGroup();if(b)b.sendToBack();else if(c){var d=c.getObjects();a.discardActiveGroup(),d.forEach(function(a){a.sendToBack()})}else{var e=wpStamp.getObjectById($(this).parent().parent().attr("data-id"));wpStamp.canvas.sendToBack(e)}var f=$(this).parent().parent().index();f<$("ul#layers").size()&&$("#layers li:eq("+f+")").before($("#layers li:eq("+(f+1)+")"))}catch(g){console.log(g)}},checkPrice:function(){"front"==wpStamp.side?wpStamp.b_json=wpStamp.canvas.getObjects():wpStamp.a_json=wpStamp.canvas.getObjects();try{var a=parseInt($(".adl-price").val())/100,b=parseFloat($(".real-price").val()),c=$(".amount").html();wpStamp.a_json.length>0&&wpStamp.b_json.length>0?($(".amount").html(b+a*b),$(".amount").prepend(c[0])):(0==wpStamp.b_json.length||0==wpStamp.a_json.length)&&($(".amount").html(b),$(".amount").prepend(c[0]))}catch(d){}},cache:function(){wpStamp.canvas.forEachObject(function(a,b){if("image"!==a.type){var c=a.scaleX,d=a.scaleY;wpStamp.canvas.remove(a),a.scale(1).cloneAsImage(function(e){e.set({left:a.left,top:a.top,scaleX:c,scaleY:d}),console.log(e.id),$("#layers").find("li#"+a.id).remove(),wpStamp.canvas.insertAt(e,b)})}})}},Brightness=Darkroom.Transformation.extend({applyTransformation:function(a,b,c){var d=this.options.bright;b.filters.push(new fabric.Image.filters.Brightness({brightness:d})),b.applyFilters(a.renderAll.bind(a)),c()}});Darkroom.plugins.brightness=Darkroom.Plugin.extend({initialize:function(){var a=this.darkroom.toolbar.createButtonGroup(),b=a.createButton({image:"brightness_high"}),c=a.createButton({image:"brightness_low"});b.addEventListener("click",this.brighten.bind(this)),c.addEventListener("click",this.darken.bind(this))},brighten:function(){this.brightness(10)},darken:function(){this.brightness(-10)},brightness:function(a){this.darkroom.applyTransformation(new Brightness({bright:a}))}}),$(document).ready(function(){wpStamp.init()});